
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feedback | Mediusware</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Barlow:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    
    <link 
        rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" 
        integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" 
        crossorigin="anonymous"
    />
    <link rel="stylesheet" href="{% static 'css/list.css' %}">
    <style>
        * {
            font-family: 'Barlow', sans-serif;
        }
        .container {
            padding-left: 6%; /* Adjust as needed */
            padding-right: 6%; /* Adjust as needed */
        }
        thead tr {
            background-color: #f9f9f9;
        }
        tbody tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        tbody tr:nth-child(odd) {
            background-color: #ffffff;
        }
        div.messages {
            background: tomato;
        }
        div.messages div.alert-danger {
            background: tomato;
        }

        .table td, .table th {
            vertical-align: middle;
        }

        .table th {
            text-align: left;
        }

        .popover-wrapper {
            position: relative;
        }

        .popover-title {
            font-weight: bold;
        }

        .popover-message {
            display: none;
        }

        .popover-wrapper:hover .popover-message {
            display: block;
        }


    </style>
</head>
<body>

    {% if temp_token %}

    <div class="container py-3 pb-5">

            {% if messages %}
            <div class="row">
                <div class="col-12">
                    {% for message in messages %}
                        <div{% if message.tags %} class="alert {{ message.tags }}"{% endif %}>{{ message }}</div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

        <!-- HEADING -->
        <div class="row">
            <div class="text-center">
                <h2 class="h1 fs-1">Client Satisfaction  Survey</h2>
                <h3 class="h3 fs-5"> Project: {{ project.title }}</h3>
            </div>
            <hr>
            <div class="">
                <div class="">
                    {% if not feedback_objs %}
                    <p>
                            We value your honest feedback as it helps us improve and deliver even better results in the future. Please take a few moments to share your thoughts on the project. Your insights are crucial to our growth and ensuring that we meet your expectations. Please don't hesitate to give your honest (positive/negative) opinion.
                    </p>
                    {% else %}
                    <p>
                            Thank you for your feedback! We appreciate your time and insights, and weâ€™ll use your comments to enhance our services. If you have any more thoughts, feel free to reach out. Thanks again for helping us improve!
                    </p>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- FORM -->
        {% if not current_feedback_exists or update_feedback %}
        <div class="row">
            <div class="col-12">
                {% include 'admin/form/client_feedback_form.html' %}   
            </div>
        </div>
        {% endif %}

        <!-- TABLE -->
    {% if feedback_objs %}
        <div class="row">
            <div class="col-12">
{#                <h5 class="h5 pb-3">Feedback History ({{ project.title }})</h5>#}
                <div class="table-responsive">
                    <table class="table w-100 table-bordered rounded">
                        <thead>
                            <tr style="display: None">
                                <th class="border" scope="col">Attribute</th>
                                <th class="border" scope="col">Value</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for fback_obj in feedback_objs %}
                                <tr>
                                    <td style="font-weight: bold;">Month</td>
                                    <td>{{ fback_obj.feedback_month|date:"F Y" }}</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: bold;">Overall Satisfaction</td>
                                    <td>{{ fback_obj.rating_overall_satisfaction }}</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: bold;">Communication</td>
                                    <td>{{ fback_obj.rating_communication }}</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: bold;">Quality of Work</td>
                                    <td>{{ fback_obj.rating_quality_of_work }}</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: bold;">Time Management</td>
                                    <td>{{ fback_obj.rating_time_management }}</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: bold;">Requirements Understanding</td>
                                    <td>{{ fback_obj.rating_understanding_of_requirements }}</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: bold;">Value for Money</td>
                                    <td>{{ fback_obj.rating_value_for_money }}</td>
                                </tr>

                                <tr>
                                    <td style="font-weight: bold;">Recommendations</td>
                                    <td>{{ fback_obj.rating_recommendations }}</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: bold;">Feedback</td>
                                    <td>
                                        {% if fback_obj.feedback|length >= 150 %}
                                            <div class="popover-wrapper">
                                                <div class="popover-title">
                                                    {{ fback_obj.feedback|stringformat:".100s" }}
                                                </div>
                                                <div class="popover-message">
                                                    {{ fback_obj.feedback }}
                                                </div>
                                            </div>
                                        {% else %}
                                            <div>{{ fback_obj.feedback }}</div>
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr style="background-color: #2853a1; font-weight: bold; color: #ffffff; ">
                                    <td>Average</td>
                                    <td>{{ fback_obj.avg_rating }}</td>
                                </tr>
                                {% if forloop.counter == 1 and current_feedback_exists %}
                                    <tr>
                                        <td colspan="2">
                                            <a class="btn btn-primary btn-sm" style="font-weight: bold" href="{% url 'admin:client_feedback_form' token=temp_token %}">Edit</a>
                                        </td>
                                    </tr>
                                {% endif %}
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    {% endif %}


        
    </div>

    {% endif %}

</body>
</html>
